

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installing &mdash; Merlin  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Clustering" href="clustering.html" />
    <link rel="prev" title="Changelog" href="changelog.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Merlin
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using merlin</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#dependencies-requirements">Dependencies &amp; Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#from-package-repositories">From package repositories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#centos-7">CentOS 7</a></li>
<li class="toctree-l3"><a class="reference internal" href="#centos-8">CentOS 8</a></li>
<li class="toctree-l3"><a class="reference internal" href="#post-install-steps">Post install steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="#with-thruk">With Thruk</a></li>
<li class="toctree-l3"><a class="reference internal" href="#development-snapshot">Development snapshot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#from-rpm-files">From .rpm files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slim-packages">Slim packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compiling-from-source">Compiling from source</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-and-installation">Building and installation</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="encryption.html">Encrypted communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="container-poller.html">Merlin container poller</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Merlin</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Installing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/install.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
            
  <div class="section" id="installing">
<h1>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="dependencies-requirements">
<h2>Dependencies &amp; Requirements<a class="headerlink" href="#dependencies-requirements" title="Permalink to this headline">¶</a></h2>
<p>Merlin is currently tested on CentOS 7 &amp; CentOS 8. Merlin requires Naemon, and
the Naemon binary must be installed at <code class="docutils literal notranslate"><span class="pre">/usr/bin/naemon</span></code>.</p>
</div>
<div class="section" id="from-package-repositories">
<h2>From package repositories<a class="headerlink" href="#from-package-repositories" title="Permalink to this headline">¶</a></h2>
<p>Installing via repositories hosted at openSUSE Build Service is the recommended
approach. This makes updating easy using the OS provided package manager.</p>
<p>Prior to installing we need to ensure that the EPEL release is included, as
dependencies from EPEL are required. Hereafter we can install the relevant
<cite>.repo</cite> files, both for Naemon and Merlin. Finally we can install merlin using
the package manager.</p>
<div class="section" id="centos-7">
<h3>CentOS 7<a class="headerlink" href="#centos-7" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>yum install -y epel-release
curl -s https://download.opensuse.org/repositories/home:/naemon/CentOS_7/home:naemon.repo &gt;&gt; /etc/yum.repos.d/naemon-stable.repo
curl -s https://download.opensuse.org/repositories/home:/itrs-op5/CentOS_7/home:itrs-op5.repo &gt;&gt; /etc/yum.repos.d/itrs-op5.repo
yum install merlin
systemctl enable naemon &amp;&amp; systemctl start naemon
</pre></div>
</div>
</div>
<div class="section" id="centos-8">
<h3>CentOS 8<a class="headerlink" href="#centos-8" title="Permalink to this headline">¶</a></h3>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>dnf install -y epel-release
curl -s https://download.opensuse.org/repositories/home:/naemon/CentOS_8_Stream/home:naemon.repo &gt;&gt; /etc/yum.repos.d/naemon-stable.repo
curl -s https://download.opensuse.org/repositories/home:/itrs-op5/CentOS_8_Stream/home:itrs-op5.repo &gt;&gt; /etc/yum.repos.d/itrs-op5.repo
dnf install merlin
systemctl enable naemon &amp;&amp; systemctl start naemon
</pre></div>
</div>
</div>
<div class="section" id="post-install-steps">
<h3>Post install steps<a class="headerlink" href="#post-install-steps" title="Permalink to this headline">¶</a></h3>
<p>Clustering relies on having a running SSH server. Enable the SSH server by:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>systemctl enable sshd
systemctl start sshd
</pre></div>
</div>
</div>
<div class="section" id="with-thruk">
<h3>With Thruk<a class="headerlink" href="#with-thruk" title="Permalink to this headline">¶</a></h3>
<p>If you wish to install the Thruk UI, add <code class="docutils literal notranslate"><span class="pre">naemon</span></code> to the dnf/yum install
commands above.</p>
</div>
<div class="section" id="development-snapshot">
<h3>Development snapshot<a class="headerlink" href="#development-snapshot" title="Permalink to this headline">¶</a></h3>
<p>Development snapshots are built anytime there is a merge to master. If you need
a feature not yet included for release, you can install the development snapshot
by replacing the repo definitions above with either corresponding one below.</p>
<p><strong>CentOS 7:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>https://download.opensuse.org/repositories/home:/itrs-op5:/master/CentOS_7/home:itrs-op5:master.repo
</pre></div>
</div>
<p><strong>CentOS 8:</strong></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>https://download.opensuse.org/repositories/home:/itrs-op5:/master/CentOS_8_Stream/home:itrs-op5:master.repo
</pre></div>
</div>
</div>
</div>
<div class="section" id="from-rpm-files">
<h2>From .rpm files<a class="headerlink" href="#from-rpm-files" title="Permalink to this headline">¶</a></h2>
<p>Releases are also published on <a class="reference external" href="https://github.com/ITRS-Group/monitor-merlin/releases">Github</a>. Each release contain a set of tar.xz
files containing the built rpm sources.</p>
<p>Extract the achieve and install the complete all RPMs in a single command using
your package manager (yum/dnf). Prior to installing ensure that Naemon is either
installed or the Naemon repository has been added.</p>
</div>
<div class="section" id="slim-packages">
<h2>Slim packages<a class="headerlink" href="#slim-packages" title="Permalink to this headline">¶</a></h2>
<p>Currently two sets of packages are being built. <em>Normal</em> packages and <em>slim</em>
packages which are denoted <code class="docutils literal notranslate"><span class="pre">-slim</span></code>. The slim packages are intended for use
in containers, for example with the Merlin container poller.</p>
<p>Some of the differences with the slim packages are noted below:</p>
<ul class="simple">
<li><p>No systemd service files</p></li>
<li><p>No database is installed</p></li>
<li><p>Includes container specific healthchecks</p></li>
<li><p>Includes the <code class="docutils literal notranslate"><span class="pre">cluster_tools</span></code> script which helps registering with master nodes</p></li>
</ul>
</div>
<div class="section" id="compiling-from-source">
<h2>Compiling from source<a class="headerlink" href="#compiling-from-source" title="Permalink to this headline">¶</a></h2>
<p><strong>Needs review, this section is potentially out of date and needs updating</strong></p>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<p>Merlin requires Naemon, including its development headers for building.
Currently, it requires version &gt;= 1.2.4.</p>
<p>Other general build requirements: gcc, autoconf, automake, glib-2-devel,
check-devel, libdbi-devel, libtool, naemon-devel, gperf</p>
<p>For running Merlin with its default configuration, you’ll need to have
libdbi-dbd-mysql and all of its dependencies (generally libdbi-drivers, libdbi
and mysql-libs) installed.</p>
<p>You will of course also need an sql database supported by libdbi (refer to the
libdbi documentation for further information about supported databases), as
well as a Naemon installation that the Merlin module can plug in to. The import
script is currently limited to MySQL only, so that’s currently the only
database supported.</p>
<p>The install script requires sql administration privileges in order to create
the database that merlin will populate for you.</p>
<p>GNU sed 4.0.9 or better is required for the install script to be able to modify
your naemon configuration files.</p>
<p>For redundant/distributed installation you also need sudo rights for naemon
user to be able to reload the configuration on all your nodes in the cluster.
The command that needs to be executed ‘sudo mon restart’.</p>
</div>
<div class="section" id="building-and-installation">
<h3>Building and installation<a class="headerlink" href="#building-and-installation" title="Permalink to this headline">¶</a></h3>
<p>Building is a standard autotools flair. Checkout with git, or download the
release tarball and run</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>./autogen.sh
make
sudo make install
</pre></div>
</div>
<p>The install will by default try to install merlin’s database. The configure
script provides a way to configure database name and users, as well as a way to
prevent merlin from doing this automatically, in which case you need to run the
install-merlin.sh script manually. Run ./configure –help for more information.</p>
<p>Merlin will drop a naemon configuration file into the directory naemon’s
configuration lies. You can include it in your main naemon config file with
<code class="docutils literal notranslate"><span class="pre">include_file=merlin.cfg</span></code> or by putting the config file in an already included
directory with the <code class="docutils literal notranslate"><span class="pre">--with-naemon-config-dir</span></code> argument to the configure script.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>


           </div>
           
          </div>
    <a href="https://github.com/ITRS-Group/monitor-merlin/">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
    </a>

          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="clustering.html" class="btn btn-neutral float-right" title="Clustering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="changelog.html" class="btn btn-neutral float-left" title="Changelog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2021, ITRS Group

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>